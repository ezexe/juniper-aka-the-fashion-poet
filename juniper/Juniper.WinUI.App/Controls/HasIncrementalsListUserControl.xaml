<UserControl x:Class="Juniper.WinUI.App.Controls.HasIncrementalsListUserControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:local="using:Juniper.WinUI.App.Controls"
             xmlns:interactionCore="using:Microsoft.Xaml.Interactions.Core"
             xmlns:interaction="using:Microsoft.Xaml.Interactivity"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>
        <StackPanel Grid.Row="0"
                    Padding="{StaticResource ActionsXLargePaddingLeft}"
                    HorizontalAlignment="Stretch">
            <Grid HorizontalAlignment="Stretch">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>
                <TextBlock Text="{x:Bind TitleHeader}"
                           Style="{StaticResource TitleTextBlockStyle}"
                           FontSize="24"
                           LineHeight="32"
                           HorizontalAlignment="Stretch"
                           VerticalAlignment="Center"/>

                <AppBarToggleButton x:Name="ToggleSwitch2"
                                    Grid.Column="1"
                                    Margin="{StaticResource ActionsPaddingSmallRight}"
                                    LabelPosition="Collapsed"
                                    VerticalAlignment="Center"
                                    HorizontalAlignment="Right"
                                    Click="ToggleSwitch2_Click">
                    <Viewbox MaxWidth="{StaticResource SquareButtonIconSmall}"
                             MaxHeight="{StaticResource SquareButtonIconSmall}">
                        <SymbolIcon Symbol="Bullets" />
                    </Viewbox>
                </AppBarToggleButton>
            </Grid>

            <CheckBox x:Name="saCheckBox"
                      Visibility="{x:Bind ToggleSwitch2.IsChecked, Mode=OneWay,Converter={StaticResource boolToVisibilityConverter}}"
                      Content="Select All"
                      Margin="0,0,0,0"
                      IsThreeState="True"
                      Checked="CheckBox_Checked"
                      Unchecked="CheckBox_Unchecked"
                      Indeterminate="CheckBox_Indeterminate" />
        </StackPanel>


        <ListView x:Name="lvIncItems"
                  Margin="{StaticResource ActionsMediumPaddingLeftRight}"
                  Grid.Row="1"
                  SelectionMode="Single"
                  ScrollViewer.VerticalScrollBarVisibility="Auto"
                  SelectedItem="{x:Bind SelectedItemsSource,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"
                  ItemsSource="{x:Bind ItemsSource,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"
                  SelectionChanged="lvIncItems_SelectionChanged">
            <ListView.ItemTemplate>
                <DataTemplate>
                    <Grid x:Name="controlMain"
                          Padding="{StaticResource ActionsPaddingSmall}">
                        <interaction:Interaction.Behaviors>
                            <interactionCore:DataTriggerBehavior Binding="{Binding IsDupe,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"
                                                                 Value="True">
                                <interactionCore:ChangePropertyAction TargetObject="{Binding ElementName=controlMain}"
                                                                      PropertyName="Background"
                                                                      Value="{StaticResource SystemFillColorCautionBackgroundBrush}" />
                            </interactionCore:DataTriggerBehavior>

                            <interactionCore:DataTriggerBehavior Binding="{Binding IsDupe,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"
                                                                 Value="False">
                                <interactionCore:ChangePropertyAction TargetObject="{Binding ElementName=controlMain}"
                                                                      PropertyName="Background"
                                                                      Value="Transparent" />
                            </interactionCore:DataTriggerBehavior>
                        </interaction:Interaction.Behaviors>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>
                        <TextBlock VerticalAlignment="Center"
                                   Style="{StaticResource SubtitleTextBlockStyle}">
                                        <Run Text="{Binding StringId}" />
                        </TextBlock>

                        <TextBlock Text="{Binding FileCreationTime, 
                                        Converter={StaticResource StringFormatConverter},   
                                        ConverterParameter=' {0:MM/dd hh:mm:ss.fff}'}"
                                   TextWrapping="Wrap"
                                   Visibility="{Binding IsDupe,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged,Converter={StaticResource boolToVisibilityConverter}}"
                                   Grid.Column="1" />

                        <Grid Margin="0"
                              Grid.Column="2"
                              VerticalAlignment="Top"
                              CornerRadius="{StaticResource ControlCornerRadius}"
                              Visibility="{Binding Status,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged, Converter={StaticResource DocumentStatusToEnabledConverter}, ConverterParameter=StatusVisual}">
                            <Ellipse Fill="{ThemeResource SystemAccentColorDark1}"
                                     Width="{StaticResource smallIconElementSize}"
                                     Height="{StaticResource smallIconElementSize}" />
                        </Grid>
                    </Grid>
                </DataTemplate>
            </ListView.ItemTemplate>
        </ListView>

        <!--  Options Display  -->
        <ContentPresenter x:Name="OptionsPresenter"
                          Grid.Row="2"
                          HorizontalAlignment="Stretch"
                          CornerRadius="{StaticResource ControlCornerRadius}"
                          Content="{x:Bind Options}"
                          Visibility="{x:Bind Options, Converter={StaticResource nullToVisibilityConverter}}" />
    </Grid>
</UserControl>
