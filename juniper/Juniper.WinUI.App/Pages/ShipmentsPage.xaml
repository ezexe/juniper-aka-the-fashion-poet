<local:FilterablePageBase x:Class="Juniper.WinUI.App.Pages.ShipmentsPage"
                          xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                          xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                          xmlns:local="using:Juniper.WinUI.App.Pages"
                          xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                          xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                          mc:Ignorable="d"
                          xmlns:interactionCore="using:Microsoft.Xaml.Interactions.Core"
                          xmlns:interaction="using:Microsoft.Xaml.Interactivity"
                          xmlns:userControls="using:Juniper.WinUI.App.Controls"
                          xmlns:dos="using:Juniper.WinUI.App.DependencyObjects"
                          xmlns:models="using:Juniper.Core.Models"
                          xmlns:viewModels="using:Juniper.Core.ViewModels"
                          NavigationCacheMode="Enabled">
    <Page.Resources>
        <DataTemplate x:DataType="viewModels:InvoiceViewModel"
                      x:Name="InvoicesvmTemplate">
            <Grid HorizontalAlignment="Stretch">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>
                <StackPanel HorizontalAlignment="Center"
                            VerticalAlignment="Center">
                    <TextBlock HorizontalAlignment="Center"
                               VerticalAlignment="Center"
                               Style="{StaticResource SubtitleTextBlockStyle}"
                               Text="{x:Bind InvoiceHeader.InvoiceNumber}" />
                </StackPanel>

                <Button Grid.Column="1"
                        Style="{StaticResource DateTimePickerFlyoutButtonStyle}"
                        ToolTipService.ToolTip="View Stores">
                    <Button.Content>
                        <StackPanel>
                            <SymbolIcon Symbol="Tag" />
                            <TextBlock Text="Store" />
                        </StackPanel>
                    </Button.Content>
                    <Button.Flyout>
                        <Flyout>
                            <Flyout.Content>
                                <GridView ItemsSource="{x:Bind InvoiceHeader.Address}"
                                          ItemContainerStyle="{StaticResource InvisGridViewItemStyle}"
                                          Width="{StaticResource MultipleOf4RectWidthXLarge}">
                                    <GridView.ItemTemplate>
                                        <DataTemplate x:DataType="models:BaseAddressModel">
                                            <TextBlock Style="{StaticResource BodyTextBlockStyle}">
                                                <Run Text="TC:" />
                                                <Run Text="{x:Bind SelectedAddressTypeCode}" />
                                                <Run Text="Loc#:" />
                                                <Run Text="{x:Bind AddressLocationNumber}" />
                                            </TextBlock>
                                        </DataTemplate>
                                    </GridView.ItemTemplate>
                                </GridView>
                            </Flyout.Content>
                        </Flyout>
                    </Button.Flyout>
                </Button>
            </Grid>
        </DataTemplate>

        <DataTemplate x:DataType="viewModels:ASNViewModel"
                      x:Name="vmTemplate">
            <Grid x:Name="controlMain"
                  Height="{StaticResource MultipleOf4RectHeightXXSmall}"
                  MinWidth="{StaticResource MultipleOf4RectWidthXLarge}"
                  BorderThickness="{StaticResource ControlBorderThickness}"
                  Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                  BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                  CornerRadius="{StaticResource ControlCornerRadius}">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition MinWidth="260" />
                    <ColumnDefinition Width="56" />
                    <ColumnDefinition Width="56" />
                </Grid.ColumnDefinitions>
                <Grid x:Name="controlRoot">
                    <StackPanel VerticalAlignment="Center"
                                HorizontalAlignment="Stretch">
                        <TextBlock  HorizontalAlignment="Center"
                                    Style="{StaticResource BodyTextBlockStyle}">
                               <Run Text="{x:Bind ShipmentHeader.ShipDate, 
                                                            Converter={StaticResource StringFormatConverter},   
                                                            ConverterParameter=' {0:ddd MM-dd-yyyy}'}" />
                        </TextBlock>

                        <TextBlock HorizontalAlignment="Center"
                                   Style="{StaticResource SubtitleTextBlockStyle}">
                                    <Run Text="{x:Bind povm.POData.Order.Header.OrderHeader.PurchaseOrderNumber}" />
                        </TextBlock>

                        <TextBlock HorizontalAlignment="Center"
                                   Style="{StaticResource SubtitleTextBlockStyle}">
                                  <Run Text="{x:Bind ShipmentHeader.ShipmentIdentification}" />
                        </TextBlock>
                    </StackPanel>
                </Grid>

                <Button Grid.Column="1"
                        Style="{StaticResource DateTimePickerFlyoutButtonStyle}"
                        VerticalAlignment="Stretch"
                        HorizontalAlignment="Stretch">
                    <Button.Content>
                        <StackPanel>
                            <SymbolIcon Symbol="Setting" />
                        </StackPanel>
                    </Button.Content>
                    <Button.Flyout>
                        <Flyout>
                            <StackPanel>
                                <TextBlock HorizontalAlignment="Left"
                                           Style="{StaticResource BodyTextBlockStyle}">
                                    <Run Text="Actuall Ship" />
                                    <Run Text="{x:Bind InternalASNSettings.InternalActuallShip, 
                                                            Converter={StaticResource StringFormatConverter},   
                                                            ConverterParameter=' {0:ddd MM-dd-yyyy}'}" />
                                </TextBlock>
                                <TextBlock HorizontalAlignment="Center"
                                           IsTextSelectionEnabled="True"
                                           Style="{StaticResource BodyTextBlockStyle}">
                                    <Run Text="Master BOL" />
                                    <Run Text="{x:Bind InternalASNSettings.MasterBOLPath,Mode=OneWay}" />
                                </TextBlock>
                            </StackPanel>
                        </Flyout>
                    </Button.Flyout>
                </Button>

                <userControls:TeachingTipButtonUserControl Grid.Column="2"
                                                           ItemsSource="{x:Bind DoneInvoicesData}"
                                                           ItemTemplate="{StaticResource InvoicesvmTemplate}"
                                                           GroupHeaderTemplate="{StaticResource GroupInfoListHeaderTemplatekK3}"
                                                           ItemSymbol="Bullets"
                                                           ItemText="{x:Bind InvoiceViewModels.Count}"
                                                           ToolTipService.ToolTip="Preview Sent Invoices List" />
            </Grid>
        </DataTemplate>
    </Page.Resources>
    <userControls:SemanticZoomBaseUserControl x:Name="sz"
                                              HeaderText="Shipments"
                                              ItemsSource="{x:Bind ViewModel.TradingPartners}"
                                              PropertyPath="ASNShipments"
                                              ItemTemplate="{StaticResource vmTemplate}"
                                              ItemListViewItemClick="OnItemListViewItemClick">
        <userControls:SemanticZoomBaseUserControl.HeaderContent>
            <CommandBar>
                <AppBarButton x:Name="ABBMasterBol"
                              Click="ABBMasterBol_Click"
                              CommandParameter="CommandBOLs"
                              Label="Master BOL"
                              Icon="Document"
                              ToolTipService.ToolTip="Create Word BOL From Checked Shipments" />

                <AppBarButton x:Name="btnsetActualShipDate"
                              Icon="Calendar"
                              Label="Ship Date"
                              ToolTipService.ToolTip="Set Selected Shipments Actual Ship Date"
                              AllowFocusOnInteraction="True">
                    <Button.Flyout>
                        <Flyout x:Name="btnsetActualShipDateFlyout"
                                Placement="Bottom">
                            <StackPanel Orientation="Horizontal"
                                        HorizontalAlignment="Stretch">
                                <DatePicker Header="Ship Date: "
                                            Margin="12"
                                            SelectedDate="{x:Bind ViewModel.ActualShipDate, Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}" />
                                <Button Click="Button_Click"
                                        VerticalAlignment="Center"
                                        Margin="6,20,0,0"
                                        Content="Save"
                                        Style="{StaticResource AccentButtonStyle}" />
                            </StackPanel>
                        </Flyout>
                    </Button.Flyout>
                </AppBarButton>

                <AppBarButton Icon="Send"
                              Label="Send Uninvoiced"
                              ToolTipService.ToolTip="Create and Send All Uninvoiced Shipments"
                              IsEnabled="{x:Bind ViewModel.SendAllShipmentInvoicesCommand.IsRunning,Mode=OneWay,Converter={StaticResource inverseBoolConverter}}">
                    <AppBarButton.Flyout>
                        <MenuFlyout Placement="Bottom"> 
                            <MenuFlyoutItem Text="All Shipments"
                                            Command="{x:Bind ViewModel.SendAllShipmentInvoicesCommand}"
                                            CommandParameter="CommandAllShipments"
                                            IsEnabled="{x:Bind ViewModel.SendAllShipmentInvoicesCommand.IsRunning,Mode=OneWay,Converter={StaticResource inverseBoolConverter}}" />
                            <MenuFlyoutItem Text="Selected Shipments"
                                            Click="MenuFlyoutItem_Click"
                                            Tag="Selected"
                                            IsEnabled="{x:Bind ViewModel.IsActionsEnabled,Mode=OneWay}" />
                        </MenuFlyout>
                    </AppBarButton.Flyout>
                </AppBarButton>

                <AppBarButton Command="{x:Bind ViewModel.OnCommand}"
                              CommandParameter="CommandStopSendAllInvoices"
                              Icon="Stop"
                              Label="Stop"
                              ToolTipService.ToolTip="Stop Sending All Uninvoiced Shipments"
                              Visibility="{x:Bind ViewModel.SendAllShipmentInvoicesCommand.IsRunning,Mode=OneWay}" />
            </CommandBar>
        </userControls:SemanticZoomBaseUserControl.HeaderContent>
        <userControls:SemanticZoomBaseUserControl.HeaderOptionsContent>
            <userControls:CanFilterUserControl INVFilterVisibility="Collapsed"
                                               ASNFilterVisibility="Visible"
                                               ASNFilterBtnVisibility="Visible"
                                               OnBeforeFilterd="CanFilterUserControl_OnBeforeFilterd" />
        </userControls:SemanticZoomBaseUserControl.HeaderOptionsContent>
        <userControls:SemanticZoomBaseUserControl.BodyOverlayOptionsContent>
            <ProgressRing Visibility="{x:Bind ViewModel.SendAllShipmentInvoicesCommand.IsRunning,Mode=OneWay}"
                          IsActive="{x:Bind ViewModel.SendAllShipmentInvoicesCommand.IsRunning,Mode=OneWay}"
                          VerticalAlignment="Top" />
        </userControls:SemanticZoomBaseUserControl.BodyOverlayOptionsContent>
    </userControls:SemanticZoomBaseUserControl>
</local:FilterablePageBase>
