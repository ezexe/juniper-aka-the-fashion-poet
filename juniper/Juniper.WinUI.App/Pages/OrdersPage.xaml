<local:FilterablePageBase x:Class="Juniper.WinUI.App.Pages.OrdersPage"
                          xmlns:local="using:Juniper.WinUI.App.Pages"
                          xmlns:dos="using:Juniper.WinUI.App.DependencyObjects"
                          xmlns:userControls="using:Juniper.WinUI.App.Controls"
                          xmlns:viewModels="using:Juniper.Core.ViewModels"
                          xmlns:models="using:Juniper.Core.Models"
                          xmlns:interactionCore="using:Microsoft.Xaml.Interactions.Core"
                          xmlns:interaction="using:Microsoft.Xaml.Interactivity"
                          xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                          xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                          xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                          xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                          mc:Ignorable="d"
                          x:Name="thisPage"
                          NavigationCacheMode="Disabled">
    <Page.Resources>
        <DataTemplate x:DataType="models:PrepackErrorDataModel"
                      x:Name="prepackErrorDataModel">
            <Grid>
                <StackPanel>
                    <TextBlock HorizontalAlignment="Center"
                               Style="{StaticResource SubtitleTextBlockStyle}">
                        <Run Text="{x:Bind Product.SizeDescription}" />
                    </TextBlock>

                    <TextBlock HorizontalAlignment="Center"
                               VerticalAlignment="Top"
                               FontSize="16"
                               Style="{StaticResource BodyTextBlockStyle}">
                        <Run Text="{x:Bind Product.GTIN}" />
                    </TextBlock>

                    <TextBlock HorizontalAlignment="Center"
                               Style="{StaticResource BodyTextBlockStyle}">
                        <Run Text="Ordered" />
                        <Run Text="{x:Bind OrderdNumber}" />
                        <Run Text=": Pre-Pack" />
                        <Run Text="{x:Bind Product.PrePackSizeNumber}" />
                    </TextBlock>

                    <TextBlock HorizontalAlignment="Center"
                               FontSize="16"
                               Style="{StaticResource BodyTextBlockStyle}">
                        <Run Text="Pre-Pack" />
                        <Run Text="{x:Bind Product.XS}" />
                        <Run Text="{x:Bind Product.S}" />
                        <Run Text="{x:Bind Product.M}" />
                        <Run Text="{x:Bind Product.L}" />
                        <Run Text="{x:Bind Product.XL}" />
                    </TextBlock>

                    <TextBlock HorizontalAlignment="Center"
                               FontSize="16"
                               Style="{StaticResource BodyTextBlockStyle}">
                        <Run Text="Ordered" />
                        <Run Text="{x:Bind OrderdBreakdown}" />
                    </TextBlock>
                </StackPanel>
            </Grid>
        </DataTemplate>

        <DataTemplate x:DataType="models:PurchaseOrderCompletionStatus"
                      x:Name="pocsDT">
            <Grid HorizontalAlignment="Stretch">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>
                <StackPanel>
                    <TextBlock HorizontalAlignment="Center"
                               FontSize="18"
                               Style="{StaticResource SubtitleTextBlockStyle}">
                        <Run Text="{x:Bind Polm.LineItem.OrderLine.ProductSizeDescription}" />
                    </TextBlock>

                    <TextBlock HorizontalAlignment="Center"
                               VerticalAlignment="Center"
                               Style="{StaticResource BodyTextBlockStyle}"
                               FontSize="14">
                        <Run Text="{x:Bind Polm.LineItem.OrderLine.ConsumerPackageCode}" />
                    </TextBlock>

                    <TextBlock HorizontalAlignment="Center"
                               VerticalAlignment="Center"
                               Style="{StaticResource BodyTextBlockStyle}"
                               FontSize="14">
                                    <Run Text="{x:Bind ASNsQtyString}" />
                                    <Run Text="locations" />
                                    <Run Text="{x:Bind LocationsStatus.Count}" />
                                    <Run Text="qty" />
                                    <Run Text="{x:Bind LocationsQty}" />
                    </TextBlock>
                </StackPanel>

                <AppBarButton Icon="Shop"
                              Label="Stores"
                              Grid.Column="1"
                              HorizontalAlignment="Right"
                              ToolTipService.ToolTip="View Stores">
                    <AppBarButton.Flyout>
                        <Flyout>
                            <Flyout.Content>
                                <GridView ItemsSource="{x:Bind LocationsStatus}"
                                          ItemContainerStyle="{StaticResource InvisGridViewItemStyle}"
                                          Width="{StaticResource MultipleOf4RectWidthXLarge}">
                                    <GridView.ItemTemplate>
                                        <DataTemplate x:DataType="models:PurchaseOrderCompletionStatusLocations">
                                            <TextBlock VerticalAlignment="Center"
                                                       Style="{StaticResource BodyTextBlockStyle}">
                                                <Run Text="#" />
                                                <Run Text="{x:Bind ASNNumber}" />
                                                <Run Text="-" />
                                                <Run Text="{x:Bind Location.Location}" />
                                                <Run Text="-" />
                                                <Run Text="{x:Bind Location.Qty}" />
                                            </TextBlock>
                                        </DataTemplate>
                                    </GridView.ItemTemplate>
                                </GridView>
                            </Flyout.Content>
                        </Flyout>
                    </AppBarButton.Flyout>
                </AppBarButton>
            </Grid>
        </DataTemplate>

        <DataTemplate x:DataType="viewModels:PurchaseOrderViewModel"
                      x:Name="povmTemplate">
            <Grid x:Name="controlMain"
                  Height="{StaticResource MultipleOf4RectHeightXXSmall}"
                  Width="{StaticResource MultipleOf4RectWidthXLarge}"
                  Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                  BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                  BorderThickness="{StaticResource ControlBorderThickness}"
                  CornerRadius="{StaticResource ControlCornerRadius}">
                <Grid.Resources>
                    <Style TargetType="AppBarButton"
                           BasedOn="{StaticResource AppBarButtonRevealStyle}">
                        <Setter Property="AllowFocusOnInteraction"
                                Value="True" />
                        <Setter Property="LabelPosition"
                                Value="Default" />
                        <Setter Property="VerticalAlignment"
                                Value="Center" />
                    </Style>
                </Grid.Resources>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition MinWidth="260" />
                    <ColumnDefinition Width="56" />
                    <ColumnDefinition Width="56" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>
                <Grid x:Name="controlRoot">
                    <interaction:Interaction.Behaviors>
                        <interactionCore:DataTriggerBehavior Binding="{x:Bind HassPrepackError,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"
                                                             Value="True">
                            <interactionCore:ChangePropertyAction TargetObject="{Binding ElementName=controlMain}"
                                                                  PropertyName="Background"
                                                                  Value="{StaticResource SystemFillColorCriticalBackgroundBrush}" />
                        </interactionCore:DataTriggerBehavior>

                        <interactionCore:DataTriggerBehavior  Binding="{x:Bind HassPrepackError,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"
                                                              Value="False">
                            <interactionCore:ChangePropertyAction TargetObject="{Binding ElementName=controlMain}"
                                                                  PropertyName="Background"
                                                                  Value="{ThemeResource CardBackgroundFillColorDefaultBrush}" />
                        </interactionCore:DataTriggerBehavior>


                        <interactionCore:DataTriggerBehavior Binding="{x:Bind Status,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged,Converter={StaticResource DocumentStatusToEnabledConverter}}"
                                                             Value="False">
                            <interactionCore:ChangePropertyAction TargetObject="{Binding ElementName=controlMain}"
                                                                  PropertyName="Background"
                                                                  Value="{StaticResource SystemFillColorSuccessBackgroundBrush}" />
                        </interactionCore:DataTriggerBehavior>
                    </interaction:Interaction.Behaviors>

                    <StackPanel VerticalAlignment="Center"
                                HorizontalAlignment="Stretch">

                        <TextBlock HorizontalAlignment="Center"
                                   Style="{StaticResource BodyTextBlockStyle}">
                                             <Run Text="{x:Bind OrderDate, 
                                                            Converter={StaticResource StringFormatConverter},   
                                                            ConverterParameter=' {0:ddd MM-dd-yyyy}'}" />
                        </TextBlock>

                        <TextBlock Padding="6"
                                   HorizontalAlignment="Center"
                                   Style="{StaticResource SubtitleTextBlockStyle}">
                                    <Run Text="{x:Bind POData.Order.Header.OrderHeader.PurchaseOrderNumber}" />
                        </TextBlock>

                        <TextBlock HorizontalAlignment="Center"
                                   Style="{StaticResource CaptionTextBlockStyle}">
                            <Run Text="{x:Bind DisplayASNStatus}" />
                        </TextBlock>
                    </StackPanel>
                </Grid>

                <userControls:TeachingTipButtonUserControl Grid.Column="1"
                                                           ItemsSource="{x:Bind OrderCompletionStatusList}"
                                                           ItemTemplate="{StaticResource pocsDT}"
                                                           GroupHeaderTemplate="{StaticResource GroupInfoListHeaderTemplate}"
                                                           ItemSymbol="Bullets"
                                                           ItemText="{x:Bind OrderCompletionStatusList.Count,Mode=OneWay}"
                                                           ToolTipService.ToolTip="Preview Order(Done:) Status" />

                <userControls:TeachingTipButtonUserControl Grid.Column="2"
                                                           ItemsSource="{x:Bind OrderIncompletionStatusList}"
                                                           ItemTemplate="{StaticResource pocsDT}"
                                                           GroupHeaderTemplate="{StaticResource GroupInfoListHeaderTemplate}"
                                                           ItemSymbol="List"
                                                           ItemText="{x:Bind OrderIncompletionStatusList.Count,Mode=OneWay}"
                                                           ToolTipService.ToolTip="Preview Order Left(To Do:) Until Complete" />

                <userControls:TeachingTipButtonUserControl Grid.Column="3"
                                                           ItemsSource="{x:Bind PrepackErrorData}"
                                                           ItemTemplate="{StaticResource prepackErrorDataModel}"
                                                           GroupHeaderTemplate="{StaticResource GroupInfoListHeaderTemplate}"
                                                           ItemSymbol="Flag"
                                                           ItemText="{x:Bind PrepackErrorData.Count,Mode=OneWay}"
                                                           ToolTipService.ToolTip="View Missmatched Prepack Order Lines"
                                                           Visibility="{x:Bind HassPrepackError,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged,Converter={StaticResource boolToVisibilityConverter}}" />
            </Grid>
        </DataTemplate>
    </Page.Resources>
    <userControls:SemanticZoomBaseUserControl x:Name="sz"
                                              HeaderText="Orders"
                                              ItemsSource="{x:Bind ViewModel.TradingPartners}"
                                              PropertyPath="PurchaseOrders"
                                              ItemTemplate="{StaticResource povmTemplate}"
                                              ItemListViewItemClick="OnItemListViewItemClick">
        <userControls:SemanticZoomBaseUserControl.HeaderContent>
            <CommandBar>
                <AppBarButton Command="{x:Bind ViewModel.OnCommand}"
                              CommandParameter="CommandReloadOrders"
                              Label="Refresh"
                              Icon="Refresh"
                              ToolTipService.ToolTip="Refresh Available Purchase Orders, Shipments and Invoices" />

                <AppBarButton Command="{x:Bind ViewModel.OnCommand}"
                              CommandParameter="CommandCheckPrepack"
                              Label="Check Prepack"
                              Icon="Flag"
                              ToolTipService.ToolTip="Check Purchase Orders Qty orderd vs available Pre-Pack Settings in UPC list" />
            </CommandBar>
        </userControls:SemanticZoomBaseUserControl.HeaderContent>
        <userControls:SemanticZoomBaseUserControl.HeaderOptionsContent>
            <userControls:CanFilterUserControl INVFilterVisibility="Collapsed"
                                               ASNFilterVisibility="Collapsed"
                                               BOLFilterVisibility="Collapsed"
                                               OnBeforeFilterd="CanFilterUserControl_OnBeforeFilterd"/>
        </userControls:SemanticZoomBaseUserControl.HeaderOptionsContent>
        <userControls:SemanticZoomBaseUserControl.BodyOverlayOptionsContent>
            <ProgressRing IsActive="{x:Bind ViewModel.IsLoading,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"
                          VerticalAlignment="Top" />
        </userControls:SemanticZoomBaseUserControl.BodyOverlayOptionsContent>
    </userControls:SemanticZoomBaseUserControl>
</local:FilterablePageBase>
